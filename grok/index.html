<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yearbook Staff Role Assessment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            box-sizing: border-box;
        }

        body {
            background: #001e4d;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .app {
            background: #fff;
            width: 90%;
            max-width: 600px;
            margin: 100px auto 0;
            border-radius: 10px;
            padding: 30px;
        }

        .app h1 {
            font-size: 25px;
            color: #001e4d;
            font-weight: 600;
            border-bottom: 1px solid #333;
            padding-bottom: 30px;
        }

        .quiz {
            padding: 20px 0;
        }

        .quiz h2 {
            font-size: 18px;
            color: #001e4d;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .btn {
            background: #fff;
            color: #222;
            font-weight: 500;
            width: 100%;
            border: 1px solid #222;
            padding: 10px;
            margin: 10px 0;
            text-align: left;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover:not([disabled]) {
            background: #222;
            color: #fff;
        }

        .btn:disabled {
            cursor: no-drop;
        }

        .btn.selected {
            background: #28a745;
            color: #fff;
            border-color: #28a745;
        }

        #next-btn {
            background: #001e4d;
            color: #fff;
            font-weight: 500;
            width: 150px;
            border: 0;
            padding: 10px;
            margin: 20px auto 0;
            border-radius: 4px;
            cursor: pointer;
            display: none;
        }

        #result {
            display: none;
            text-align: center;
        }

        #result h2 {
            color: #001e4d;
        }

        #result p {
            margin-top: 10px;
        }

        #report {
            margin-top: 20px;
            text-align: left;
        }

        #report h3 {
            color: #001e4d;
            margin-bottom: 10px;
        }

        #report ul {
            list-style-type: none;
            padding: 0;
        }

        #report li {
            margin: 5px 0;
        }

        #report .scores {
            margin-top: 20px;
        }

        #report .tasks {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="app">
        <h1>Yearbook Staff Role Assessment</h1>
        <div class="quiz">
            <h2 id="question">Question goes here</h2>
            <div id="answer-buttons">
                <!-- Buttons will be dynamically added -->
            </div>
            <button id="next-btn">Next</button>
        </div>
        <div id="result">
            <h2>Your Recommended Role: <span id="recommended-role"></span></h2>
            <p id="role-description"></p>
            <div id="report">
                <h3>Your Selections</h3>
                <ul id="selections"></ul>
                <div class="scores">
                    <h3>Role Scores</h3>
                    <p id="scores"></p>
                </div>
                <div class="tasks">
                    <h3>Common Daily Tasks for Your Role</h3>
                    <ul id="tasks"></ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // CSV Parsing Function
        function CSVToArray(strData, strDelimiter) {
            strDelimiter = (strDelimiter || ",");
            var objPattern = new RegExp(
                (
                    "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +
                    "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +
                    "([^\"\\" + strDelimiter + "\\r\\n]*))"
                ),
                "gi"
            );
            var arrData = [[]];
            var arrMatches = null;
            while (arrMatches = objPattern.exec(strData)) {
                var strMatchedDelimiter = arrMatches[1];
                if (
                    strMatchedDelimiter.length &&
                    strMatchedDelimiter !== strDelimiter
                ) {
                    arrData.push([]);
                }
                var strMatchedValue;
                if (arrMatches[2]) {
                    strMatchedValue = arrMatches[2].replace(
                        new RegExp("\"\"", "g"),
                        "\""
                    );
                } else {
                    strMatchedValue = arrMatches[3];
                }
                arrData[arrData.length - 1].push(strMatchedValue);
            }
            return (arrData);
        }

        // Role Descriptions
        const roleDescriptions = {
            leadership: "Individuals who excel in leadership roles are typically organized, decisive, and excellent communicators. They thrive on motivating teams, planning strategies, and overseeing projects to ensure deadlines are met. They are comfortable delegating tasks and resolving conflicts.",
            photography: "Successful photographers are creative, patient, and technically proficient with cameras and editing software. They have a keen eye for detail and composition, enjoy capturing moments, and are adaptable to various environments and lighting conditions.",
            design: "Designers who succeed are artistic, detail-oriented, and skilled in visual software. They have a strong sense of aesthetics, color theory, and layout principles. They enjoy creating visually appealing content and iterating on ideas based on feedback.",
            sidebar: "People good at sidebar roles are research-savvy, concise writers who can distill information into engaging, short formats. They are curious, good at finding interesting facts, and skilled in making complex info accessible.",
            journalist: "Journalists who thrive are curious, excellent writers and interviewers, with strong ethical standards. They are deadline-oriented, fact-checkers, and storytellers who can engage readers with compelling narratives.",
            page_finisher: "Page finishers are meticulous, patient, and have a sharp eye for errors. They excel in proofreading, ensuring consistency, and making final adjustments. They are organized and calm under pressure to meet print deadlines."
        };

        // Common Daily Tasks for Each Role
        const roleTasks = {
            leadership: [
                "Assign sections to staff members",
                "Coordinate with school administration for approvals",
                "Schedule weekly team meetings",
                "Track assignment completions",
                "Resolve conflicts between staff",
                "Develop a budget for yearbook production",
                "Prioritize events for coverage",
                "Facilitate brainstorming sessions",
                "Monitor supply inventory"
            ],
            photography: [
                "Scout locations for group photos",
                "Set up camera equipment before events",
                "Capture candid shots at school assemblies",
                "Pose students for club portraits",
                "Adjust lighting for indoor sports photos",
                "Take action shots during games",
                "Import photos from camera to computer",
                "Sort photos into folders by event",
                "Document school trips or field days"
            ],
            design: [
                "Arrange elements on a page in software",
                "Select templates for section layouts",
                "Place photos into layout grids",
                "Adjust margins and bleeds for printing",
                "Incorporate theme elements into designs",
                "Test layout flow for readability",
                "Export layouts for proofing",
                "Collaborate on layout revisions",
                "Create cover design mockups"
            ],
            sidebar: [
                "Develop sidebar content on trends",
                "Write quick facts lists for sidebars",
                "Design polls for sidebar inclusion",
                "Compile student quotes for sidebars",
                "Create infographics text for sidebars",
                "Research statistics for sports sidebars",
                "Format sidebar text for visual appeal",
                "Integrate sidebars into main copy",
                "Update sidebars with late-breaking info"
            ],
            journalist: [
                "Schedule interviews with students",
                "Prepare question lists for interviews",
                "Conduct in-person interviews at lunch",
                "Transcribe interview notes",
                "Write main article copy for sports section",
                "Draft feature stories on student achievements",
                "Compose summaries of school events",
                "Revise copy for word count limits",
                "Follow up on missed interview details"
            ],
            page_finisher: [
                "Read copy for spelling errors",
                "Check photo credits and attributions",
                "Verify names in captions and lists",
                "Mark up layouts for corrections",
                "Cross-check facts in articles",
                "Review grammar in sidebars",
                "Compare digital vs. printed proofs",
                "Make final edits before submission",
                "Archive proofed files"
            ]
        };

        let questions = [];
        let currentQuestionIndex = 0;
        let scores = {
            leadership: 0,
            photography: 0,
            design: 0,
            sidebar: 0,
            journalist: 0,
            page_finisher: 0
        };
        let userSelections = [];

        const questionElement = document.getElementById("question");
        const answerButtonsElement = document.getElementById("answer-buttons");
        const nextButton = document.getElementById("next-btn");
        const resultElement = document.getElementById("result");
        const recommendedRoleElement = document.getElementById("recommended-role");
        const roleDescriptionElement = document.getElementById("role-description");
        const selectionsElement = document.getElementById("selections");
        const scoresElement = document.getElementById("scores");
        const tasksElement = document.getElementById("tasks");

        // Load questions from CSV
        fetch('questions.csv')
            .then(response => response.text())
            .then(csvText => {
                const parsed = CSVToArray(csvText);
                questions = parsed.slice(1).map(row => ({
                    question: row[0],
                    answers: [
                        { text: row[1], group: row[2] },
                        { text: row[3], group: row[4] },
                        { text: row[5], group: row[6] },
                        { text: row[7], group: row[8] },
                        { text: row[9], group: row[10] },
                        { text: row[11], group: row[12] }
                    ]
                }));
                startQuiz();
            })
            .catch(error => console.error('Error loading CSV:', error));

        function startQuiz() {
            currentQuestionIndex = 0;
            scores = { leadership: 0, photography: 0, design: 0, sidebar: 0, journalist: 0, page_finisher: 0 };
            userSelections = [];
            nextButton.innerText = "Next";
            resultElement.style.display = "none";
            showQuestion();
        }

        // Fisher-Yates shuffle
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function showQuestion() {
            resetState();
            let currentQuestion = questions[currentQuestionIndex];
            questionElement.innerText = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;
            // Randomize answers
            const shuffledAnswers = shuffle([...currentQuestion.answers]);
            shuffledAnswers.forEach(answer => {
                const button = document.createElement("button");
                button.innerText = answer.text;
                button.classList.add("btn");
                button.dataset.group = answer.group;
                button.addEventListener("click", selectAnswer);
                answerButtonsElement.appendChild(button);
            });
        }

        function resetState() {
            nextButton.style.display = "none";
            while (answerButtonsElement.firstChild) {
                answerButtonsElement.removeChild(answerButtonsElement.firstChild);
            }
        }

        function selectAnswer(e) {
            const selectedBtn = e.target;
            const group = selectedBtn.dataset.group;
            scores[group]++;
            userSelections.push({
                question: questions[currentQuestionIndex].question,
                answer: selectedBtn.innerText,
                group: group
            });
            Array.from(answerButtonsElement.children).forEach(button => {
                if (button === selectedBtn) {
                    button.classList.add("selected");
                }
                button.disabled = true;
            });
            nextButton.style.display = "block";
        }

        function showResult() {
            resetState();
            questionElement.innerText = "Assessment Complete!";
            let maxScore = 0;
            let recommendedRole = "";
            for (const [role, score] of Object.entries(scores)) {
                if (score > maxScore) {
                    maxScore = score;
                    recommendedRole = role;
                }
            }
            recommendedRoleElement.innerText = recommendedRole.replace('_', ' ').toUpperCase();
            roleDescriptionElement.innerText = roleDescriptions[recommendedRole];
            
            // Generate selections report
            selectionsElement.innerHTML = "";
            userSelections.forEach((selection, index) => {
                const li = document.createElement("li");
                li.innerText = `${index + 1}. ${selection.question}: ${selection.answer} (${selection.group.replace('_', ' ')})`;
                selectionsElement.appendChild(li);
            });
            
            // Generate scores report
            scoresElement.innerText = Object.entries(scores)
                .map(([role, score]) => `${role.replace('_', ' ')}: ${score}`)
                .join(", ");
            
            // Generate tasks report
            tasksElement.innerHTML = "";
            roleTasks[recommendedRole].forEach(task => {
                const li = document.createElement("li");
                li.innerText = task;
                tasksElement.appendChild(li);
            });
            
            resultElement.style.display = "block";
            nextButton.innerText = "Restart";
            nextButton.style.display = "block";
        }

        nextButton.addEventListener("click", () => {
            if (currentQuestionIndex < questions.length) {
                handleNextButton();
            } else {
                startQuiz();
            }
        });

        function handleNextButton() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResult();
            }
        }
    </script>
</body>
</html>
